{% extends 'base.html' %} 
{% block title %} URL Report {% endblock %} 

{% block content %}


<div class="flex flex-col align-center p-4">
    <h3>Virus Detection statistics for <a href="{{website_url}}">{{website_url}}</a></h3>
    <div class="stats mb-3 mt-4">
        <div class="stat-elem">
            <p>Malicious</p>
            <div class="count-border malicious">
                <div>{{stats.malicious}}</div>
            </div>
        </div>
        <div class="stat-elem">
            <p>Suspicious</p>
            <div class="count-border">
                <div>{{stats.suspicious}}</div>
            </div>
        </div>
        <div class="stat-elem">
            <p>Harmless</p>
            <div class="count-border">
                <div>{{stats.harmless}}</div>
            </div>
        </div>
        <div class="stat-elem">
            <p>Undetected</p>
            <div class="count-border">
                <div>{{stats.undetected}}</div>
            </div>
        </div>
        <div class="stat-elem">
            <p>Timeout</p>
            <div class="count-border">
                <div>{{stats.timeout}}</div>
            </div>
        </div>
    </div>
    <div class="my-2">Detection results:</div>
    <div class="report-section">
        {% for result in result_list %}
    
        <div class="report-elem">
            <span class="engine-name">
                {{ result.name }}
            </span>
            {% if result.category == "harmless" %}
                <span class="harmless result" >
                    <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="1em"
                    height="1em"
                    fill="currentColor"
                    viewBox="0 0 24 24"
                    >
                    <path
                        d="M16.993 8.842a.6.6 0 0 0-.986-.684l-4.464 6.423-3.628-3.482a.6.6 0 1 0-.83.866l4.135 3.968a.6.6 0 0 0 .908-.09l4.865-7Z"
                    ></path>
                    <path
                        fill-rule="evenodd"
                        d="M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10Zm-1.2 0a8.8 8.8 0 1 1-17.6 0 8.8 8.8 0 0 1 17.6 0Z"
                        clip-rule="evenodd"
                    ></path>
                    </svg>
                    <span class="individual-detection">{{ result.category|capitalize }}</span>
                </span>
            {% elif result.category == "undetected" or result.category == "timeout" %}
                <span class="undetected result" >
                    <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="1em"
                    height="1em"
                    fill="currentColor"
                    viewBox="0 0 24 24"
                    >
                    <path
                        d="M12.347 15.295a.943.943 0 0 1-.943-.943v-.097c0-.506.058-.94.173-1.301.13-.376.333-.73.607-1.062.29-.347.658-.73 1.106-1.15.318-.289.6-.563.846-.823a3 3 0 0 0 .563-.824 2.34 2.34 0 0 0 .217-1.02c0-.678-.224-1.235-.672-1.668-.434-.434-1.055-.65-1.865-.65-.52 0-.96.107-1.322.324a2.635 2.635 0 0 0-.944.944c-.276.45-.834.703-1.32.497-.445-.188-.67-.695-.428-1.113a7.17 7.17 0 0 1 .415-.631c.362-.492.839-.91 1.431-1.258.593-.347 1.316-.52 2.168-.52.882 0 1.648.18 2.299.542a3.735 3.735 0 0 1 1.539 1.453c.376.607.564 1.3.564 2.08 0 .608-.13 1.15-.39 1.627a5.235 5.235 0 0 1-.868 1.236c-.332.332-.621.614-.867.845a6.388 6.388 0 0 0-.759.802c-.202.26-.354.535-.455.824-.101.29-.152.614-.152.976a.91.91 0 0 1-.91.91h-.033Zm.01 4.705c-.39 0-.722-.13-.997-.39a1.398 1.398 0 0 1-.39-.997c0-.376.13-.694.39-.954.275-.275.607-.412.998-.412.375 0 .694.137.954.412.274.26.412.578.412.954 0 .39-.138.722-.412.997a1.3 1.3 0 0 1-.954.39Z"
                    ></path>
                    </svg>
                    <span class="individual-detection">{{ result.category|capitalize }}</span>
                </span>
            {% else %}
                <span class="malicious result" >
                    <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="1em"
                    height="1em"
                    fill="currentColor"
                    viewBox="0 0 24 24"
                    >
                    <path
                        d="M11.85 5a.6.6 0 0 1 .6.6v8.8a.6.6 0 1 1-1.2 0V5.6a.6.6 0 0 1 .6-.6Zm.6 12.6a.6.6 0 1 0-1.2 0v.8a.6.6 0 1 0 1.2 0v-.8Z"
                    ></path>
                    <path
                        fill-rule="evenodd"
                        d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10Zm0-1.2a8.8 8.8 0 1 0 0-17.6 8.8 8.8 0 0 0 0 17.6Z"
                        clip-rule="evenodd"
                    ></path>
                    </svg>
                    <span class="individual-detection">{{ result.category|capitalize }}</span>
                </span>
            {% endif %}
    
        </div>
        {% endfor %}
    
    </div>
</div>





{% endblock %}
